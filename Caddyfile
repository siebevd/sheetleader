{
    # Global options
    admin off
}

# NocoDB subdomain
studio.{$DOMAIN:localhost} {
    reverse_proxy nocodb:8080

    # Enable compression
    encode gzip

    # Logging
    log {
        output stdout
        format console
    }
}

# Main application
{$DOMAIN:localhost} {
    # Handle API requests
    handle /api/* {
        reverse_proxy backend:3000
    }

    # Serve frontend static files
    handle {
        root * /var/www/html
        try_files {path} /index.html
        file_server
    }

    # Enable compression
    encode gzip

    # Logging
    log {
        output stdout
        format console
    }
}
